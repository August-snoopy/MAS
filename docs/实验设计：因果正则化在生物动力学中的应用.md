### 实验设计：因果正则化在生物动力学中的应用

#### 1. 实验目标

目标是通过设计一系列实验来验证因果正则化（Causal Regularization）策略在生成和优化因果图方面的有效性，特别是验证结合先验知识和ANF在降维与保留生物动力学特征方面的能力。

#### 2. 数据准备

**数据集：**

- 使用公开的运动捕捉数据集以及私有数据集，如 [Human3.6M](http://vision.imar.ro/human3.6m/) 或 [CMU Motion Capture](http://mocap.cs.cmu.edu/) AMASS。
- 包含各种动作（如步行、跑步、引体向上等）的**长时间序列数据**。
- 每个动作序列应包含关节坐标、速度、加速度等特征。

**数据预处理：**

- 对动作数据进行时间对齐和归一化处理。
- 将长时间序列数据下采样，分割成固定长度的窗口（如每段20秒，500帧）。
- 生成初始先验图，定义虚拟节点并全连接到各关节节点。

#### 3. 实验方法

##### 3.1. 因果图生成

**步骤：**

1. **模型初始化：** 初始化一个多层感知机（MLP）用于 ANF 调节。选择适当的层数和神经元数量。

2. **先验图构建：** 
   - 利用生物动力学知识构建先验图。
   - 定义虚拟节点，表示动作类别标签，并使其均匀全连接到所有关节节点。

3. **因果图生成：**
   - 使用 ANF 逐步生成因果图。 
   - 通过梯度下降算法调整网络参数，使生成的因果图与先验图接近，同时应用 L2 正则化使邻接关系的权重接近0。

**实验步骤：**

1. **训练 ANF 模型：** 使用数据集中长时间序列数据，基于损失函数（MSE）训练 ANF 模型。
3. **输出优化因果图：** 输出在训练过程中损失最小的因果图，并保存用于后续分析。

**超参数设置：**

- 学习率：初始为 0.001，采用自适应学习率优化器。
- 正则化参数：L2 正则化系数设为 0.01。

##### 3.2. 消融实验设计

**消融实验目的：**

验证不同组件（如 ANF、L2 正则化、先验图构建等）对因果图生成效果的贡献。

**实验步骤：**

1. **全模型实验：** 
   - 使用完整模型（含先验图、ANF、L2 正则化）。
   - 记录最终的因果图及其评价指标（如残差、MSE）。

2. **去除 ANF：** 
   - 仅使用 L2 正则化和先验图，去除 ANF 的自回归调整部分。
   - 比较生成的因果图与全模型的差异。

3. **去除 L2 正则化：**
   - 保留 ANF 和先验图，去除 L2 正则化项。
   - 记录因果图及评价指标。

4. **去除先验图：**
   - 仅使用 ANF 和 L2 正则化，不使用先验图。
   - 比较因果图与其它实验的差异。

5. **去除虚拟节点：**
   - 在完整模型中去除虚拟节点，仅保留关节节点的因果关系。
   - 观察因果图对动作类别表示的影响。

**评价指标：**

- **残差**：计算生成因果图与先验图之间的残差。
- **均方误差（MSE）**：评估生成因果图与先验图之间的 MSE。
- **结构相似度（SSIM）**：量化生成因果图与先验图结构的相似性。
- **计算复杂度**：记录每种模型的计算时间和资源占用情况。

##### 3.3. 多尺度时空图神经网络（MSGNN）

**步骤：**

1. **多尺度图生成：** 基于不同时间窗口（如5秒、10秒、15秒）生成多尺度因果图。
2. **MSGNN 构建：** 将多尺度因果图输入至多尺度时空图神经网络，设计融合层以整合不同尺度的信息。
3. **模型训练：** 使用动作序列数据训练 MSGNN，目标是优化动作识别精度。

**模型结构：**

- **输入层**：多尺度因果图。
- **中间层**：图卷积网络（GCN）或图注意力网络（GAT）层。
- **融合层**：整合不同尺度图的特征。
- **输出层**：动作类别标签预测。

**训练细节：**

- **损失函数**：交叉熵损失结合残差损失。
- **优化器**：Adam优化器，初始学习率0.001。
